<div class="container">
  <div class="section">
    <div class="columns is-multiline">
      <div class="column is-12">
        <div class="panel">
          <%= form_tag(recipes_path, method: 'get', local: true, class: 'control') do |form| %>
          <% @safe_params.except(:search).each do |k, v| %>
          <%= hidden_field_tag k, v %>
          <% end %>
          <div class="field has-addons">
            <p class="control is-expanded">
            <%= text_field_tag :search, params[:search], placeholder: 'Enter a title', class: 'input is-fullwidth' %>
            </p>
            <p class="control">
            <%= submit_tag 'Search', class: 'button is-primary' %>
            </p>
            <p class="control is-hidden-desktop">
            <a class="button is-outlined" id="toggle-filters" aria-label="<%= t(".toggle_filters_box") %>">
              <span class="icon is-small"><i class="fa fa-filter"></i></span>
            </a>
          </p>
          </div>
          <% end %>
        </div>
      </div>
      <div class="column is-3-desktop is-12-touch is-hidden-touch" id="filters-box">
        <nav class="panel">
          <p class="panel-heading">
          Filters
          </p>

          <div class="panel-block">
            <aside class="menu">
              <p class="menu-label">
              Courses
              </p>
              <ul class="menu-list">
                <%= courses_menu %>
              </ul>
              <p class="menu-label">
              Cuisines
              </p>
              <ul class="menu-list">
                <%= cuisines_menu %>
              </ul>
              <p class="menu-label">
              Ordering
              </p>
              <ul class="menu-list">
                <%= ordering_menu %>
              </ul>
            </aside>
          </div>
        </nav>
      </div>
      <div class="column is-12-touch is-9-desktop">
        <div class="columns is-multiline">
          <% @recipes.each do |recipe| %>
          <% present(recipe) do |recipe_presenter| %>
          <div class="column is-one-quarter">
            <div class="card medium round">
              <div class="card-image ">
                <figure class="image">
                  <%= link_to short_account_recipe_path(recipe.account, recipe) do %>
                  <% if recipe.photo.attached? %>
                  <%= image_tag recipe.main_picture_variant, alt: 'image' %>
                  <% else %>
                  <%= image_tag "/background.png", alt: 'image' %>
                  <% end %>
                  <% end %>
                </figure>
              </div>
              <div class="card-content">
                <div class="media">
                  <div class="media-content">
                    <p class="subtitle is-5 no-padding ellipsed-title"><%= link_to recipe.title, short_account_recipe_path(recipe.account, recipe), title: recipe.title %></p>
                  </div>
                </div>
                <div class="content">
                  <p class="ellipsed-info"><%= recipe.info %></p>
                  <p><i class="fa fa-clock-o" aria-hidden="true" title="<%= t(".total_time") %>"></i> <%= recipe_presenter.total_time %> <%= t('units.minutes') %></p>
                  <p class="is-pulled-right"><small><%= l(recipe.created_at.to_date) %></small></p>
                </div>
              </div>
            </div>
          </div>
          <% end %>
          <% end %>
        </div>
        <%= paginate @recipes %>
      </div>
    </div>
  </div>
</div>
